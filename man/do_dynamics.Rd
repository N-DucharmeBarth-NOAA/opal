% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dynamics.R
\name{do_dynamics}
\alias{do_dynamics}
\title{Population dynamics}
\usage{
do_dynamics(
  data,
  parameters,
  B0,
  R0,
  alpha,
  beta,
  h = 0.95,
  sigma_r = 0.6,
  M_a,
  maturity_a,
  weight_fya,
  init_number_a,
  sel_fya
)
}
\arguments{
\item{data}{A \code{list} of model data.  Must contain at minimum:
\code{first_yr}, \code{first_yr_catch}, \code{n_year}, \code{n_season},
\code{n_fishery}, \code{n_age}, \code{catch_obs_ysf},
\code{catch_units_f}.}

\item{parameters}{A \code{list} of model parameters.  Must contain at
minimum: \code{rdev_y}.}

\item{B0}{Numeric. Unfished equilibrium spawning biomass.}

\item{R0}{Numeric. Unfished equilibrium recruitment.}

\item{alpha}{Numeric. Beverton-Holt stock-recruitment alpha parameter.}

\item{beta}{Numeric. Beverton-Holt stock-recruitment beta parameter.}

\item{h}{Numeric (0.2â€“1). Steepness of the Beverton-Holt
stock-recruitment relationship.}

\item{sigma_r}{Numeric > 0. Standard deviation of log recruitment
deviations.}

\item{M_a}{Numeric vector of length \code{n_age}. Natural mortality at age.
Passed explicitly so AD gradients propagate if M is ever estimated.}

\item{maturity_a}{Numeric vector of length \code{n_age}. Maturity at age.
Passed explicitly so AD gradients propagate if growth is ever estimated.}

\item{weight_fya}{Numeric array \code{[n_fishery, n_year, n_age]}. Mean
weight at age by fishery and year.  Passed explicitly so AD gradients
propagate if growth is ever estimated.}

\item{init_number_a}{Numeric vector of length \code{n_age}. Initial
equilibrium numbers-at-age (from \code{\link{get_initial_numbers}}).}

\item{sel_fya}{Numeric array \code{[n_fishery, n_year, n_age]}.
Fishery-specific selectivity at age by year (from
\code{\link{get_selectivity}}).}
}
\value{
A named list with:
\describe{
\item{number_ysa}{Numbers-at-age array \code{[n_year+1, n_season, n_age]}.}
\item{lp_penalty}{Total penalty from \code{\link{posfun}} (harvest rate constraints).}
}
}
\description{
Runs the core age- and season-structured population dynamics loop for bigeye
tuna. Starts from initial equilibrium numbers (derived from B0 and h),
applies seasonal harvest, natural mortality, spawning, and recruitment
(Beverton-Holt with log-normal deviates), and computes predicted catches and
harvest rates.
}
\details{
All derived biology arrays (\code{M_a}, \code{maturity_a},
\code{weight_fya}) are passed as explicit arguments rather than read from
\code{data}. This ensures that AD gradients propagate correctly if any of
these quantities carry estimated parameters in the future (e.g., growth
parameters estimated via the PLA, or natural mortality via the Lorenzen
equation).
}

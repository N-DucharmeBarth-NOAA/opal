<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The BET model • opal</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Fira_Code-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Montserrat-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The BET model">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">opal</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/bet.html">The BET model</a></li>
    <li><a class="dropdown-item" href="../articles/quickstart.html">Quickstart Guide</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/N-DucharmeBarth-NOAA/opal" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/N-DucharmeBarth-NOAA/opal/issues" aria-label="Report an issue"><span class="fa fas fa-bug"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>The BET model</h1>
            
      

      <div class="d-none name"><code>bet.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>opal</code> package is an R package that contains example
fisheries data from western and central pacific bigeye tuna (BET). This
page provides examples using the <code>opal</code> BET model.</p>
</div>
<div class="section level2">
<h2 id="load-inputs">Load inputs<a class="anchor" aria-label="anchor" href="#load-inputs"></a>
</h2>
<p>Load the <code>opal</code> package and the <code>RTMB</code>
dependency. The <code>ggplot2</code> package is used for plotting.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># library(ggplot2)</span></span>
<span><span class="co"># library(dplyr)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://n-ducharmebarth-noaa.github.io/opal/">opal</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kaskr/RTMB" class="external-link">RTMB</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/get_theme.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The bundled data object <code>wcpo_bet_data</code> contains all
biological parameters, catch and CPUE observations, length structure,
and prior specifications needed for the BET assessment model:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">wcpo_bet_data</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">wcpo_bet_data</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "age_a"          "n_age"          "n_season"       "n_fishery"     </span></span>
<span><span class="co">#&gt;  [5] "len_bin_start"  "len_bin_width"  "n_len"          "first_yr"      </span></span>
<span><span class="co">#&gt;  [9] "last_yr"        "years"          "n_year"         "first_yr_catch"</span></span>
<span><span class="co">#&gt; [13] "catch_units_f"  "cpue_switch"    "cpue_data"      "A1"            </span></span>
<span><span class="co">#&gt; [17] "A2"             "lw_a"           "lw_b"           "maturity"      </span></span>
<span><span class="co">#&gt; [21] "fecundity"      "M"              "catch_obs_ysf"  "sel_type_f"    </span></span>
<span><span class="co">#&gt; [25] "priors"</span></span></code></pre></div>
<p>Key dimensions of the data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of ages:"</span>, <span class="va">data</span><span class="op">$</span><span class="va">n_age</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of ages: 40</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of years:"</span>, <span class="va">data</span><span class="op">$</span><span class="va">n_year</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of years: 268</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of fisheries:"</span>, <span class="va">data</span><span class="op">$</span><span class="va">n_fishery</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of fisheries: 15</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of length bins:"</span>, <span class="va">data</span><span class="op">$</span><span class="va">n_len</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of length bins: 95</span></span></code></pre></div>
<div class="section level3">
<h3 id="biological-inputs">Biological inputs<a class="anchor" aria-label="anchor" href="#biological-inputs"></a>
</h3>
<p>Natural mortality at age, maturity at length, and length-weight
parameters are all contained in the data object.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ages</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">age_a</span></span>
<span><span class="va">real_age</span> <span class="op">&lt;-</span> <span class="va">ages</span> <span class="op">/</span> <span class="fl">4</span></span>
<span></span>
<span><span class="co"># Natural mortality</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age <span class="op">=</span> <span class="va">real_age</span>, M <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">M</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">M</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Age (years)"</span>, y <span class="op">=</span> <span class="st">"M (quarterly rate)"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Natural Mortality-at-Age"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bet_files/figure-html/plot-biology-1.png" class="r-plt" alt="" width="672"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Maturity at length</span></span>
<span><span class="va">len_mid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">len_bin_start</span> <span class="op">+</span> <span class="va">data</span><span class="op">$</span><span class="va">len_bin_width</span> <span class="op">/</span> <span class="fl">2</span>,</span>
<span>               by <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">len_bin_width</span>, length.out <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">n_len</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>length <span class="op">=</span> <span class="va">len_mid</span>, maturity <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">maturity</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">length</span>, y <span class="op">=</span> <span class="va">maturity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Length (cm)"</span>, y <span class="op">=</span> <span class="st">"Maturity"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Maturity-at-Length"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bet_files/figure-html/plot-biology-2.png" class="r-plt" alt="" width="672"></p>
</div>
<div class="section level3">
<h3 id="length-composition-data">Length composition data<a class="anchor" aria-label="anchor" href="#length-composition-data"></a>
</h3>
<p>Length composition observations are loaded from the bundled
<code>wcpo_bet_lf</code> long-format data object and transformed into
model-ready arrays.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">wcpo_bet_lf</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pivot to wide format: one row per fishery x timestep, bins as columns</span></span>
<span><span class="co"># Note: LF data exist for fisheries 8-14, but we initially use only fisheries 8 &amp; 9</span></span>
<span><span class="va">lf_wide</span> <span class="op">&lt;-</span> <span class="va">wcpo_bet_lf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>    id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fishery</span>, <span class="va">year</span>, <span class="va">month</span>, <span class="va">ts</span><span class="op">)</span>,</span>
<span>    names_from <span class="op">=</span> <span class="va">bin</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">value</span>,</span>
<span>    values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">fishery</span>, <span class="va">ts</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define variance adjustment scalars for each fishery if using lf_switch = 1 (multinomial)</span></span>
<span><span class="va">var_adjust_scalars</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">data</span><span class="op">$</span><span class="va">n_fishery</span><span class="op">)</span></span>
<span><span class="co"># var_adjust_scalars &lt;- 1/rep(20000,data$n_fishery)</span></span>
<span><span class="co"># var_adjust_scalars[c(1,4,5,6,15)] &lt;- 1/40000</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_lf_data.html">prep_lf_data</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">lf_wide</span>, lf_keep_fisheries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">9</span><span class="op">)</span>,</span>
<span>                     lf_var_adjust <span class="op">=</span> <span class="va">var_adjust_scalars</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="model-setup">Model setup<a class="anchor" aria-label="anchor" href="#model-setup"></a>
</h2>
<div class="section level3">
<h3 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h3>
<p>Define the initial parameter values. Growth parameters
(<code>log_L1</code>, <code>log_L2</code>, <code>log_k</code>,
<code>log_CV1</code>, <code>log_CV2</code>) and selectivity
(<code>par_sel</code>) are initialised at reasonable starting values.
Load these from the bundled <code>wcpo_bet_parameters</code> data
object:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">wcpo_bet_parameters</span><span class="op">)</span></span>
<span></span>
<span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  log_B0 <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  log_h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">wcpo_bet_parameters</span><span class="op">$</span><span class="va">log_h</span><span class="op">)</span>,</span>
<span>  log_sigma_r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">wcpo_bet_parameters</span><span class="op">$</span><span class="va">log_sigma_r</span><span class="op">)</span>,</span>
<span>  log_cpue_q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">wcpo_bet_parameters</span><span class="op">$</span><span class="va">log_cpue_q</span><span class="op">)</span>,</span>
<span>  cpue_creep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">wcpo_bet_parameters</span><span class="op">$</span><span class="va">cpue_creep</span><span class="op">)</span>,</span>
<span>  log_cpue_tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">wcpo_bet_parameters</span><span class="op">$</span><span class="va">log_cpue_tau</span><span class="op">)</span>,</span>
<span>  log_cpue_omega <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">wcpo_bet_parameters</span><span class="op">$</span><span class="va">log_cpue_omega</span><span class="op">)</span>,</span>
<span>  log_lf_tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="va">data</span><span class="op">$</span><span class="va">n_fishery</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  log_L1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">wcpo_bet_parameters</span><span class="op">$</span><span class="va">log_L1</span><span class="op">)</span>,</span>
<span>  log_L2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">wcpo_bet_parameters</span><span class="op">$</span><span class="va">log_L2</span><span class="op">)</span>,</span>
<span>  log_k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">wcpo_bet_parameters</span><span class="op">$</span><span class="va">log_k</span><span class="op">)</span>,</span>
<span>  log_CV1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">wcpo_bet_parameters</span><span class="op">$</span><span class="va">log_CV1</span><span class="op">)</span>,</span>
<span>  log_CV2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">wcpo_bet_parameters</span><span class="op">$</span><span class="va">log_CV2</span><span class="op">)</span>,</span>
<span>  par_sel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">wcpo_bet_parameters</span><span class="op">$</span><span class="va">par_sel</span><span class="op">)</span>,</span>
<span>  rdev_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">wcpo_bet_parameters</span><span class="op">$</span><span class="va">rdev_y</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="priors">Priors<a class="anchor" aria-label="anchor" href="#priors"></a>
</h3>
<p>Priors are specified using <code><a href="../reference/get_priors.html">get_priors()</a></code>. The data object
already contains prior center values for growth parameters:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span><span class="op">$</span><span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_priors.html">get_priors</a></span><span class="op">(</span>parameters <span class="op">=</span> <span class="va">parameters</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/evaluate_priors.html">evaluate_priors</a></span><span class="op">(</span>parameters <span class="op">=</span> <span class="va">parameters</span>, priors <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">priors</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 92427.24</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="parameter-map">Parameter map<a class="anchor" aria-label="anchor" href="#parameter-map"></a>
</h3>
<p>Use RTMB’s <code>map</code> option to turn parameters on/off.
Parameters mapped to <code>factor(NA)</code> are fixed at their initial
values:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">$</span><span class="va">par_sel</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">$</span><span class="va">par_sel</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">map_sel</span><span class="op">[</span><span class="fl">8</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">map_sel</span><span class="op">[</span><span class="fl">9</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">map_sel</span><span class="op">[</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">map_sel</span><span class="op">[</span><span class="fl">9</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">map_sel</span><span class="op">[</span><span class="fl">8</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">map_sel</span><span class="op">[</span><span class="fl">9</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">map_rdev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">$</span><span class="va">rdev_y</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">map_lf_tau</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">$</span><span class="va">log_lf_tau</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">map_lf_tau</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">9</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="va">map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="co"># log_B0 = factor(NA),</span></span>
<span>  log_h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>  log_sigma_r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>  <span class="co"># log_cpue_q = factor(NA),</span></span>
<span>  cpue_creep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>  log_cpue_tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>  log_cpue_omega <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>  log_lf_tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">map_lf_tau</span><span class="op">)</span>,</span>
<span>  log_L1  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>  log_L2  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>  log_k   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>  log_CV1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>  log_CV2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>  par_sel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">map_sel</span><span class="op">)</span></span>
<span>  <span class="co"># rdev_y = as.factor(map_rdev),</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="build-the-ad-object">Build the AD object<a class="anchor" aria-label="anchor" href="#build-the-ad-object"></a>
</h3>
<p>Using the <code>data</code>, the <code>parameters</code>, the
parameter <code>map</code>, and the model (<code>opal_model</code>), the
AD object is created using RTMB’s <code>MakeADFun</code> function:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span><span class="op">$</span><span class="va">lf_switch</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># multinomial likelihood on flat counts (default)</span></span>
<span><span class="co"># data$lf_switch &lt;- 2 # fails while fitting, need to sort out log_lf_tau for this, use simulate to tune and find</span></span>
<span><span class="co"># data$lf_switch &lt;- 3 # fails - wants integers - think this should be an issue to RTMBdist guys</span></span>
<span></span>
<span><span class="co"># Optionally, we could also specify random effects here (e.g. `random = "rdev_y"`), but we'll start with a simpler fixed-effects model to check everything is working first.</span></span>
<span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu">MakeADFun</span><span class="op">(</span>func <span class="op">=</span> <span class="fu"><a href="../reference/cmb.html">cmb</a></span><span class="op">(</span><span class="va">opal_model</span>, <span class="va">data</span><span class="op">)</span>, parameters <span class="op">=</span> <span class="va">parameters</span>, map <span class="op">=</span> <span class="va">map</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "log_B0"     "log_cpue_q" "par_sel"    "rdev_y"</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="fu">fn</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 134424.1</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="fu">gr</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; outer mgc:  133368</span></span>
<span><span class="co">#&gt;          [,1]     [,2]    [,3]     [,4]     [,5]      [,6]      [,7]     [,8]</span></span>
<span><span class="co">#&gt; [1,] 1.283559 847.8735 -133368 34580.67 10039.04 -1615.304 -2525.923 5595.121</span></span>
<span><span class="co">#&gt;           [,9]     [,10]     [,11]     [,12]     [,13]     [,14]     [,15]</span></span>
<span><span class="co">#&gt; [1,] -14.42373 -17.79091 -11.96625 -12.08163 -23.62672 -17.25554 -17.79412</span></span>
<span><span class="co">#&gt;        [,16]     [,17]     [,18]     [,19]     [,20]     [,21]     [,22]</span></span>
<span><span class="co">#&gt; [1,] -22.425 -21.47014 -9.492821 -9.487043 -34.25532 -13.94378 -24.41817</span></span>
<span><span class="co">#&gt;          [,23]     [,24]     [,25]     [,26]     [,27]     [,28]     [,29]</span></span>
<span><span class="co">#&gt; [1,] -21.90769 -13.48098 -7.581472 -20.25591 -26.55707 -11.59815 -17.71141</span></span>
<span><span class="co">#&gt;          [,30]     [,31]     [,32]    [,33]    [,34]     [,35]     [,36]</span></span>
<span><span class="co">#&gt; [1,] -14.77482 -11.33642 -8.327971 -8.96007 -11.6725 -14.40481 -18.79485</span></span>
<span><span class="co">#&gt;          [,37]     [,38]     [,39]    [,40]     [,41]     [,42]    [,43]</span></span>
<span><span class="co">#&gt; [1,] -10.89253 -12.52936 -13.77128 -16.7568 -7.612169 -19.80656 -13.2092</span></span>
<span><span class="co">#&gt;          [,44]     [,45]     [,46]     [,47]     [,48]    [,49]     [,50]</span></span>
<span><span class="co">#&gt; [1,] -10.29417 -14.54021 -12.02666 -28.96282 -10.74705 -10.2815 -14.14097</span></span>
<span><span class="co">#&gt;          [,51]    [,52]     [,53]     [,54]     [,55]     [,56]     [,57]</span></span>
<span><span class="co">#&gt; [1,] -22.33503 -9.90664 -8.281683 -11.64374 -9.064876 -10.29405 -9.664478</span></span>
<span><span class="co">#&gt;          [,58]     [,59]     [,60]     [,61]     [,62]     [,63]     [,64]</span></span>
<span><span class="co">#&gt; [1,] -13.90944 -8.889367 -10.53526 -21.16105 -6.615882 -7.256252 -8.705208</span></span>
<span><span class="co">#&gt;          [,65]    [,66]     [,67]     [,68]     [,69]     [,70]     [,71]</span></span>
<span><span class="co">#&gt; [1,] -6.171801 -5.83139 -6.230671 -4.644741 -12.92809 -4.819266 -4.237605</span></span>
<span><span class="co">#&gt;         [,72]     [,73]     [,74]     [,75]     [,76]     [,77]     [,78]</span></span>
<span><span class="co">#&gt; [1,] -4.83079 -4.725531 -3.042983 -2.802723 -2.735913 -3.041889 -2.956688</span></span>
<span><span class="co">#&gt;          [,79]     [,80]     [,81]     [,82]    [,83]    [,84]     [,85]</span></span>
<span><span class="co">#&gt; [1,] -2.832056 -2.950518 -3.325519 -3.373152 -2.71565 -1.90421 -1.532612</span></span>
<span><span class="co">#&gt;          [,86]     [,87]      [,88]     [,89]     [,90]     [,91]     [,92]</span></span>
<span><span class="co">#&gt; [1,] -1.110487 -2.979341 -0.7495767 -3.512314 -1.775151 -2.770009 -2.894131</span></span>
<span><span class="co">#&gt;          [,93]     [,94]     [,95]     [,96]     [,97]     [,98]    [,99]</span></span>
<span><span class="co">#&gt; [1,] -3.200336 -3.530947 -3.947154 -3.963475 -3.887601 -3.864565 -3.65377</span></span>
<span><span class="co">#&gt;        [,100]    [,101]    [,102]    [,103]    [,104]    [,105]    [,106]</span></span>
<span><span class="co">#&gt; [1,] -3.86449 -3.413029 -2.858822 -2.516414 -2.421942 -1.873611 0.1267772</span></span>
<span><span class="co">#&gt;         [,107]   [,108]  [,109]   [,110]   [,111]   [,112]  [,113]   [,114]</span></span>
<span><span class="co">#&gt; [1,] 0.9110396 4.349335 3.56786 -1.37208 3.879227 1.018149 1.27915 -1.85131</span></span>
<span><span class="co">#&gt;        [,115]  [,116]   [,117]   [,118]     [,119]   [,120]   [,121]   [,122]</span></span>
<span><span class="co">#&gt; [1,] 2.258086 1.64341 3.415289 3.686082 -0.3844454 10.15892 4.477783 8.043484</span></span>
<span><span class="co">#&gt;        [,123]   [,124]   [,125]   [,126]   [,127]   [,128]   [,129]   [,130]</span></span>
<span><span class="co">#&gt; [1,] 9.868662 2.966459 4.498426 10.61197 6.183317 5.398775 20.12911 1.603732</span></span>
<span><span class="co">#&gt;         [,131]    [,132]   [,133]   [,134]   [,135]   [,136]     [,137]</span></span>
<span><span class="co">#&gt; [1,] 0.1650621 0.9320455 10.95296 14.25796 5.440251 19.92351 -0.3016632</span></span>
<span><span class="co">#&gt;        [,138]   [,139]   [,140]   [,141]   [,142]   [,143]   [,144]   [,145]</span></span>
<span><span class="co">#&gt; [1,] 1.697023 4.131396 4.966179 4.839128 4.653109 18.31732 7.044734 3.955484</span></span>
<span><span class="co">#&gt;        [,146]  [,147]   [,148]   [,149]   [,150]    [,151]    [,152]   [,153]</span></span>
<span><span class="co">#&gt; [1,] 3.024506 92.8257 35.58872 45.51684 73.66507 -72.26733 -184.5494 65.96103</span></span>
<span><span class="co">#&gt;         [,154]    [,155]   [,156]   [,157]  [,158]   [,159]    [,160]    [,161]</span></span>
<span><span class="co">#&gt; [1,] -318.1379 -179.2867 255.5759 235.1899 187.914 -42.7416 -88.10128 -17.57306</span></span>
<span><span class="co">#&gt;         [,162]    [,163]    [,164]    [,165]   [,166]   [,167]     [,168]</span></span>
<span><span class="co">#&gt; [1,] -111.0605 -133.7156 -269.3846 -109.8594 201.4434 30.68756 -0.4588547</span></span>
<span><span class="co">#&gt;        [,169]   [,170]    [,171]   [,172]   [,173]    [,174]    [,175]   [,176]</span></span>
<span><span class="co">#&gt; [1,] 161.8331 103.0581 -16.94057 29.59203 312.2648 -125.2455 -15.82691 275.7488</span></span>
<span><span class="co">#&gt;         [,177]    [,178]    [,179]    [,180]    [,181]   [,182]   [,183]</span></span>
<span><span class="co">#&gt; [1,] -85.94097 -173.5342 -610.3124 -128.6917 -513.4837 25.29142 746.1919</span></span>
<span><span class="co">#&gt;        [,184]    [,185]    [,186]    [,187]   [,188]   [,189]   [,190]</span></span>
<span><span class="co">#&gt; [1,] 283.4917 -606.6894 -1198.241 -344.7203 1597.985 453.6914 616.1131</span></span>
<span><span class="co">#&gt;         [,191]    [,192]    [,193]    [,194]   [,195]   [,196]   [,197]</span></span>
<span><span class="co">#&gt; [1,] -291.8059 -470.7017 -2306.502 -349.7535 537.7777 1572.384 2951.304</span></span>
<span><span class="co">#&gt;        [,198]    [,199]    [,200]    [,201]    [,202]    [,203]    [,204]</span></span>
<span><span class="co">#&gt; [1,] 48.57432 -500.9493 -355.4578 -420.0505 -656.7727 -953.5728 -845.6572</span></span>
<span><span class="co">#&gt;        [,205]   [,206]  [,207]   [,208]   [,209]    [,210]    [,211]    [,212]</span></span>
<span><span class="co">#&gt; [1,] 406.8608 1047.019 178.954 498.7094 155.1375 -271.9153 -213.7467 -41.94074</span></span>
<span><span class="co">#&gt;        [,213]   [,214]    [,215]    [,216]   [,217]    [,218]    [,219]</span></span>
<span><span class="co">#&gt; [1,] 344.8872 355.1801 -360.7799 -287.8721 173.4785 -129.4135 -46.37659</span></span>
<span><span class="co">#&gt;        [,220]   [,221]   [,222]    [,223]   [,224]    [,225]   [,226]   [,227]</span></span>
<span><span class="co">#&gt; [1,] 204.7333 788.5733 -8.16132 -272.3347 19.99657 -71.28219 541.5011 197.5311</span></span>
<span><span class="co">#&gt;        [,228]    [,229]    [,230]   [,231]  [,232]   [,233]   [,234]    [,235]</span></span>
<span><span class="co">#&gt; [1,] 308.8046 -553.5524 -870.1115 -241.801 351.364 629.2007 413.6063 -79.50617</span></span>
<span><span class="co">#&gt;         [,236]    [,237]    [,238]    [,239]    [,240]    [,241]   [,242]</span></span>
<span><span class="co">#&gt; [1,] -594.2893 -298.4981 -1081.499 -415.2285 -130.2232 -60.01887 3185.805</span></span>
<span><span class="co">#&gt;        [,243]   [,244]   [,245]   [,246]    [,247]    [,248]   [,249]   [,250]</span></span>
<span><span class="co">#&gt; [1,] 408.0679 1235.054 142.8773 29.82557 -1253.426 -671.8458 812.6589 69.88638</span></span>
<span><span class="co">#&gt;         [,251]    [,252]   [,253]    [,254]    [,255]   [,256]    [,257]</span></span>
<span><span class="co">#&gt; [1,] -600.1491 -141.6265 373.5507 -780.2418 -706.1567 233.5268 -158.4664</span></span>
<span><span class="co">#&gt;         [,258]    [,259]  [,260]    [,261]    [,262]   [,263]  [,264]   [,265]</span></span>
<span><span class="co">#&gt; [1,] -406.3222 -515.1598 161.159 -725.4307 -536.3243 869.2207 386.896 93.48939</span></span>
<span><span class="co">#&gt;        [,266]   [,267]   [,268]    [,269]   [,270]   [,271]   [,272]   [,273]</span></span>
<span><span class="co">#&gt; [1,] 692.0882 595.3564 1460.613 -1.630662 -933.118 13.88269 253.6477 -613.092</span></span>
<span><span class="co">#&gt;         [,274]    [,275]    [,276]</span></span>
<span><span class="co">#&gt; [1,] -1011.023 -42.43524 0.6256006</span></span></code></pre></div>
<p>Inspect initial model outputs:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="fu">report</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">spawning_biomass_y</span>, type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time step"</span>, ylab <span class="op">=</span> <span class="st">"Spawning biomass (mt)"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Initial spawning biomass trajectory"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bet_files/figure-html/init-checks-1.png" class="r-plt" alt="" width="672"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plot_catch.html">plot_catch</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, obj <span class="op">=</span> <span class="va">obj</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "The maximum catch difference was: 1.10394466901198e-08"</span></span></code></pre></div>
<p><img src="bet_files/figure-html/init-checks-2.png" class="r-plt" alt="" width="672"></p>
</div>
<div class="section level3">
<h3 id="parameter-bounds">Parameter bounds<a class="anchor" aria-label="anchor" href="#parameter-bounds"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Lwr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Upr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">Inf</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Lwr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"log_B0"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Upr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"log_B0"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">22</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Lwr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"log_cpue_q"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">Upr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"log_cpue_q"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">Lwr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"log_lf_tau"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">9</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"log_lf_tau"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Upr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"log_lf_tau"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"log_lf_tau"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Lwr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"rdev_y"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"rdev_y"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Upr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"rdev_y"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"rdev_y"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Lwr[grep("par_sel", names(obj$par))] &lt;- rep(-7, length(grep("par_sel", names(obj$par))))</span></span>
<span><span class="co"># Upr[grep("par_sel", names(obj$par))] &lt;- rep(7, length(grep("par_sel", names(obj$par))))</span></span>
<span><span class="va">bounds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="va">par</span><span class="op">)</span>, lower <span class="op">=</span> <span class="va">Lwr</span>, upper <span class="op">=</span> <span class="va">Upr</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="optimisation">Optimisation<a class="anchor" aria-label="anchor" href="#optimisation"></a>
</h2>
<p>Optimise using the <code>nlminb</code> function, do it twice to be
sure to be sure (said with Irish accent):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>eval.max <span class="op">=</span> <span class="fl">10000</span>, iter.max <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span><span class="va">opt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">nlminb</a></span><span class="op">(</span>start <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="va">par</span>, objective <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="va">fn</span>, gradient <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="va">gr</span>,</span>
<span>              hessian <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="va">he</span>, lower <span class="op">=</span> <span class="va">Lwr</span>, upper <span class="op">=</span> <span class="va">Upr</span>, control <span class="op">=</span> <span class="va">control</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in nlminb(start = obj$par, objective = obj$fn, gradient = obj$gr, :</span></span>
<span><span class="co">#&gt; NA/NaN function evaluation</span></span>
<span><span class="co">#&gt; Warning in nlminb(start = obj$par, objective = obj$fn, gradient = obj$gr, :</span></span>
<span><span class="co">#&gt; NA/NaN function evaluation</span></span>
<span><span class="co">#&gt; Warning in nlminb(start = obj$par, objective = obj$fn, gradient = obj$gr, :</span></span>
<span><span class="co">#&gt; NA/NaN function evaluation</span></span>
<span><span class="co">#&gt; Warning in nlminb(start = obj$par, objective = obj$fn, gradient = obj$gr, :</span></span>
<span><span class="co">#&gt; NA/NaN function evaluation</span></span>
<span><span class="co">#&gt; Warning in nlminb(start = obj$par, objective = obj$fn, gradient = obj$gr, :</span></span>
<span><span class="co">#&gt; NA/NaN function evaluation</span></span>
<span><span class="co">#&gt; Warning in nlminb(start = obj$par, objective = obj$fn, gradient = obj$gr, :</span></span>
<span><span class="co">#&gt; NA/NaN function evaluation</span></span>
<span><span class="va">opt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">nlminb</a></span><span class="op">(</span>start <span class="op">=</span> <span class="va">opt</span><span class="op">$</span><span class="va">par</span>, objective <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="va">fn</span>, gradient <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="va">gr</span>,</span>
<span>              hessian <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="va">he</span>, lower <span class="op">=</span> <span class="va">Lwr</span>, upper <span class="op">=</span> <span class="va">Upr</span>, control <span class="op">=</span> <span class="va">control</span><span class="op">)</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="fu">fn</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="fu">gr</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="fu">report</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">lp_prior</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="fu">report</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">lp_penalty</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="fu">report</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">lp_rec</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="fu">report</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">lp_cpue</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="fu">report</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">lp_lf</span><span class="op">)</span></span></code></pre></div>
<p>Compare initial and estimated parameter values:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_par_table.html">get_par_table</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">parameters</span>, <span class="va">map</span>, lower <span class="op">=</span> <span class="va">Lwr</span>, upper <span class="op">=</span> <span class="va">Upr</span>, grad_tol <span class="op">=</span> <span class="fl">1e-2</span>, digits <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span></span>
<span><span class="co">#&gt; outer mgc:  0.007797127</span></span>
<span><span class="co">#&gt;          par   init     est  lwr  upr       gr gr_chk bd_chk</span></span>
<span><span class="co">#&gt; 1     log_B0 20.000 14.0000  0.0 22.0 -5.7e-05     OK     OK</span></span>
<span><span class="co">#&gt; 2 log_cpue_q  0.000  0.0079 -2.3  2.3 -7.0e-08     OK     OK</span></span>
<span><span class="co">#&gt; 3   par_sel8 -0.980 -0.9700 -Inf  Inf -4.3e-03     OK     OK</span></span>
<span><span class="co">#&gt; 4   par_sel9 -0.780 -1.0000 -Inf  Inf -7.8e-03     OK     OK</span></span>
<span><span class="co">#&gt; 5  par_sel38  0.044 -9.4000 -Inf  Inf  1.1e-05     OK     OK</span></span>
<span><span class="co">#&gt; 6  par_sel39  1.600 -9.3000 -Inf  Inf  2.1e-05     OK     OK</span></span>
<span><span class="co">#&gt; 7  par_sel53  0.450 -2.3000 -Inf  Inf -5.3e-06     OK     OK</span></span>
<span><span class="co">#&gt; 8  par_sel54  3.000  1.7000 -Inf  Inf -1.1e-05     OK     OK</span></span></code></pre></div>
<div class="section level3">
<h3 id="diagnostics">Diagnostics<a class="anchor" aria-label="anchor" href="#diagnostics"></a>
</h3>
<p>Check that all parameters are estimable using the
<code>check_estimability</code> function:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_estimability.html">check_estimability</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">obj</span><span class="op">)</span></span>
<span><span class="co">#&gt; outer mgc:  0.007797127 </span></span>
<span><span class="co">#&gt; outer mgc:  347.4191 </span></span>
<span><span class="co">#&gt; outer mgc:  351.1383 </span></span>
<span><span class="co">#&gt; outer mgc:  7.425739 </span></span>
<span><span class="co">#&gt; outer mgc:  7.425739 </span></span>
<span><span class="co">#&gt; outer mgc:  3890.009 </span></span>
<span><span class="co">#&gt; outer mgc:  8195.903 </span></span>
<span><span class="co">#&gt; outer mgc:  465.0801 </span></span>
<span><span class="co">#&gt; outer mgc:  992.6296 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00779724 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007797017 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007934167 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007662319 </span></span>
<span><span class="co">#&gt; outer mgc:  58.15492 </span></span>
<span><span class="co">#&gt; outer mgc:  58.12802 </span></span>
<span><span class="co">#&gt; outer mgc:  21.19234 </span></span>
<span><span class="co">#&gt; outer mgc:  21.20837 </span></span>
<span><span class="co">#&gt; outer mgc:  0.3042917 </span></span>
<span><span class="co">#&gt; outer mgc:  0.3039646 </span></span>
<span><span class="co">#&gt; outer mgc:  0.0168823 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01686519 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01673788 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01672092 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01686756 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01685045 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01659518 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01657792 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01697672 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01695944 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01684651 </span></span>
<span><span class="co">#&gt; outer mgc:  0.0168294 </span></span>
<span><span class="co">#&gt; outer mgc:  0.0165236 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01650681 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01566827 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01565199 </span></span>
<span><span class="co">#&gt; outer mgc:  0.015449 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01543328 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01504047 </span></span>
<span><span class="co">#&gt; outer mgc:  0.0150252 </span></span>
<span><span class="co">#&gt; outer mgc:  0.271319 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2710141 </span></span>
<span><span class="co">#&gt; outer mgc:  0.0143702 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01435541 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01477368 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01475858 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01492106 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01490585 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01501283 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01499748 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01417652 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01416134 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01457219 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01455715 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01406494 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01405043 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01329361 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01327982 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01163089 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01161816 </span></span>
<span><span class="co">#&gt; outer mgc:  0.0114122 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01140017 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01065472 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01064346 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009949407 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009938796 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008817778 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008807932 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009066733 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008503312 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009179949 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008414484 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009271946 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008575734 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009265323 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008580709 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009427784 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008858965 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009508113 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009003823 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009652928 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00926113 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009849682 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009615703 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01033174 </span></span>
<span><span class="co">#&gt; outer mgc:  0.010207 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01088821 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01076297 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01113734 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01101186 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01090837 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01078305 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01053753 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01041259 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01012187 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00999739 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009849496 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009645841 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009738101 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009458365 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009748011 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009479297 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009835656 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009633935 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01010983 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009985377 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01065228 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01052723 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01144435 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01131856 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01190145 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01177527 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01184947 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01172335 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01160906 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01148312 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01125066 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01112508 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01067919 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01055419 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01017753 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01005302 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009914762 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00966156 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009745639 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009341869 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00956059 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00899242 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009435119 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008745897 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009423527 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008694951 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009580175 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00892421 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009838855 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009318922 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01016868 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009827112 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01032978 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01005826 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01020348 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009793525 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009704892 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008910153 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009153944 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00795618 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008720043 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007465795 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008521329 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007480718 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008496089 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007482545 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008614105 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007473548 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008929922 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00744955 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009489634 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008212525 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01011798 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009152219 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01064516 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009932563 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01096953 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01039584 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01079453 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01007328 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01012761 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008993946 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009442102 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007903338 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008907146 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007450101 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008542685 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007477635 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008301649 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007495837 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008198832 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007503592 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008260478 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007498871 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008478382 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007482322 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008796794 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007458264 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009209696 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007927082 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009648842 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008455333 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01006153 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008871859 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01029942 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009005262 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01034388 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008962654 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01021663 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008741177 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009941929 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008296411 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009642196 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007816099 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009506909 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007578715 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009597869 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007670362 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009873071 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008044975 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01008183 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008619414 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009956648 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008895553 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009401577 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008554835 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008913837 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008250284 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008534289 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008027432 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008320723 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008047212 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00820206 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008195192 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008433278 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008426301 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008300722 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008293873 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008041757 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007840537 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008012135 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007582335 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007989294 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00760515 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007968397 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007626025 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007952011 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007642396 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007939502 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007654896 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007933779 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00766061 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007928972 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007665411 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007924016 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007670363 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007915784 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007678588 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007902178 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007692183 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007879573 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007714767 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007849955 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007744359 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007816303 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00777798 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007781992 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00781226 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007748696 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007845526 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007716073 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00787812 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007684534 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007909628 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007648952 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007945178 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007611636 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007982462 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007571233 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008022832 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007530986 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008063037 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007478699 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008115283 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007418096 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008175841 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007354256 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008239624 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007285163 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008308651 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007194915 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008398823 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007076828 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008516815 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00691879 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008674713 </span></span>
<span><span class="co">#&gt; outer mgc:  0.006698457 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008894824 </span></span>
<span><span class="co">#&gt; outer mgc:  0.006344087 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00924886 </span></span>
<span><span class="co">#&gt; outer mgc:  0.005756287 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009836135 </span></span>
<span><span class="co">#&gt; outer mgc:  0.004808432 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01078313 </span></span>
<span><span class="co">#&gt; outer mgc:  0.004274963 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01214914 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007448901 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01610319 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01388222 </span></span>
<span><span class="co">#&gt; outer mgc:  0.02253104 </span></span>
<span><span class="co">#&gt; outer mgc:  0.02339296 </span></span>
<span><span class="co">#&gt; outer mgc:  0.03203203 </span></span>
<span><span class="co">#&gt; outer mgc:  0.03498395 </span></span>
<span><span class="co">#&gt; outer mgc:  0.04360542 </span></span>
<span><span class="co">#&gt; outer mgc:  0.05541214 </span></span>
<span><span class="co">#&gt; outer mgc:  0.06401444 </span></span>
<span><span class="co">#&gt; outer mgc:  0.7409086 </span></span>
<span><span class="co">#&gt; outer mgc:  0.7490625 </span></span>
<span><span class="co">#&gt; outer mgc:  2.155005 </span></span>
<span><span class="co">#&gt; outer mgc:  2.162579 </span></span>
<span><span class="co">#&gt; outer mgc:  0.0780389 </span></span>
<span><span class="co">#&gt; outer mgc:  0.08662286 </span></span>
<span><span class="co">#&gt; outer mgc:  0.5778662 </span></span>
<span><span class="co">#&gt; outer mgc:  0.5856053 </span></span>
<span><span class="co">#&gt; outer mgc:  0.823831 </span></span>
<span><span class="co">#&gt; outer mgc:  0.8319971 </span></span>
<span><span class="co">#&gt; outer mgc:  0.1034709 </span></span>
<span><span class="co">#&gt; outer mgc:  0.1120505 </span></span>
<span><span class="co">#&gt; outer mgc:  0.1219531 </span></span>
<span><span class="co">#&gt; outer mgc:  0.1132092 </span></span>
<span><span class="co">#&gt; outer mgc:  1.482771 </span></span>
<span><span class="co">#&gt; outer mgc:  1.474451 </span></span>
<span><span class="co">#&gt; outer mgc:  0.8202699 </span></span>
<span><span class="co">#&gt; outer mgc:  0.8111862 </span></span>
<span><span class="co">#&gt; outer mgc:  0.3926228 </span></span>
<span><span class="co">#&gt; outer mgc:  0.4015062 </span></span>
<span><span class="co">#&gt; outer mgc:  0.06491398 </span></span>
<span><span class="co">#&gt; outer mgc:  0.07351285 </span></span>
<span><span class="co">#&gt; outer mgc:  1.112738 </span></span>
<span><span class="co">#&gt; outer mgc:  1.10396 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2938432 </span></span>
<span><span class="co">#&gt; outer mgc:  0.3022028 </span></span>
<span><span class="co">#&gt; outer mgc:  6.878406 </span></span>
<span><span class="co">#&gt; outer mgc:  6.886027 </span></span>
<span><span class="co">#&gt; outer mgc:  0.1274339 </span></span>
<span><span class="co">#&gt; outer mgc:  0.135969 </span></span>
<span><span class="co">#&gt; outer mgc:  1.185186 </span></span>
<span><span class="co">#&gt; outer mgc:  1.176758 </span></span>
<span><span class="co">#&gt; outer mgc:  1.516421 </span></span>
<span><span class="co">#&gt; outer mgc:  1.506853 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2779635 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2864332 </span></span>
<span><span class="co">#&gt; outer mgc:  0.6787312 </span></span>
<span><span class="co">#&gt; outer mgc:  0.6870031 </span></span>
<span><span class="co">#&gt; outer mgc:  0.5495213 </span></span>
<span><span class="co">#&gt; outer mgc:  0.5577572 </span></span>
<span><span class="co">#&gt; outer mgc:  0.7441101 </span></span>
<span><span class="co">#&gt; outer mgc:  0.7526542 </span></span>
<span><span class="co">#&gt; outer mgc:  0.3949633 </span></span>
<span><span class="co">#&gt; outer mgc:  0.4031617 </span></span>
<span><span class="co">#&gt; outer mgc:  0.06054796 </span></span>
<span><span class="co">#&gt; outer mgc:  0.06918406 </span></span>
<span><span class="co">#&gt; outer mgc:  0.4957229 </span></span>
<span><span class="co">#&gt; outer mgc:  0.5051172 </span></span>
<span><span class="co">#&gt; outer mgc:  0.7263806 </span></span>
<span><span class="co">#&gt; outer mgc:  0.717226 </span></span>
<span><span class="co">#&gt; outer mgc:  0.07382071 </span></span>
<span><span class="co">#&gt; outer mgc:  0.06499597 </span></span>
<span><span class="co">#&gt; outer mgc:  0.6017272 </span></span>
<span><span class="co">#&gt; outer mgc:  0.6095504 </span></span>
<span><span class="co">#&gt; outer mgc:  0.5534599 </span></span>
<span><span class="co">#&gt; outer mgc:  0.5616554 </span></span>
<span><span class="co">#&gt; outer mgc:  1.299205 </span></span>
<span><span class="co">#&gt; outer mgc:  1.306803 </span></span>
<span><span class="co">#&gt; outer mgc:  0.1917466 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2002726 </span></span>
<span><span class="co">#&gt; outer mgc:  5.573434 </span></span>
<span><span class="co">#&gt; outer mgc:  5.57941 </span></span>
<span><span class="co">#&gt; outer mgc:  0.07006612 </span></span>
<span><span class="co">#&gt; outer mgc:  0.07865649 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2460567 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2456817 </span></span>
<span><span class="co">#&gt; outer mgc:  1.116152 </span></span>
<span><span class="co">#&gt; outer mgc:  1.123396 </span></span>
<span><span class="co">#&gt; outer mgc:  0.5795667 </span></span>
<span><span class="co">#&gt; outer mgc:  0.5788785 </span></span>
<span><span class="co">#&gt; outer mgc:  1.205114 </span></span>
<span><span class="co">#&gt; outer mgc:  1.204542 </span></span>
<span><span class="co">#&gt; outer mgc:  0.4451883 </span></span>
<span><span class="co">#&gt; outer mgc:  0.4535981 </span></span>
<span><span class="co">#&gt; outer mgc:  0.972637 </span></span>
<span><span class="co">#&gt; outer mgc:  0.9818465 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01533162 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01736746 </span></span>
<span><span class="co">#&gt; outer mgc:  2.780024 </span></span>
<span><span class="co">#&gt; outer mgc:  2.769304 </span></span>
<span><span class="co">#&gt; outer mgc:  3.014167 </span></span>
<span><span class="co">#&gt; outer mgc:  3.00493 </span></span>
<span><span class="co">#&gt; outer mgc:  7.589536 </span></span>
<span><span class="co">#&gt; outer mgc:  7.593513 </span></span>
<span><span class="co">#&gt; outer mgc:  10.92017 </span></span>
<span><span class="co">#&gt; outer mgc:  10.92508 </span></span>
<span><span class="co">#&gt; outer mgc:  3.536842 </span></span>
<span><span class="co">#&gt; outer mgc:  3.543199 </span></span>
<span><span class="co">#&gt; outer mgc:  0.3038261 </span></span>
<span><span class="co">#&gt; outer mgc:  0.3123261 </span></span>
<span><span class="co">#&gt; outer mgc:  0.1715483 </span></span>
<span><span class="co">#&gt; outer mgc:  0.1626341 </span></span>
<span><span class="co">#&gt; outer mgc:  0.8782286 </span></span>
<span><span class="co">#&gt; outer mgc:  0.8691346 </span></span>
<span><span class="co">#&gt; outer mgc:  1.522929 </span></span>
<span><span class="co">#&gt; outer mgc:  1.521785 </span></span>
<span><span class="co">#&gt; outer mgc:  2.87275 </span></span>
<span><span class="co">#&gt; outer mgc:  2.882766 </span></span>
<span><span class="co">#&gt; outer mgc:  1.06335 </span></span>
<span><span class="co">#&gt; outer mgc:  1.06258 </span></span>
<span><span class="co">#&gt; outer mgc:  1.234482 </span></span>
<span><span class="co">#&gt; outer mgc:  1.2246 </span></span>
<span><span class="co">#&gt; outer mgc:  8.521876 </span></span>
<span><span class="co">#&gt; outer mgc:  8.525912 </span></span>
<span><span class="co">#&gt; outer mgc:  6.759704 </span></span>
<span><span class="co">#&gt; outer mgc:  6.764074 </span></span>
<span><span class="co">#&gt; outer mgc:  1.841253 </span></span>
<span><span class="co">#&gt; outer mgc:  1.848631 </span></span>
<span><span class="co">#&gt; outer mgc:  4.00754 </span></span>
<span><span class="co">#&gt; outer mgc:  3.996792 </span></span>
<span><span class="co">#&gt; outer mgc:  4.249127 </span></span>
<span><span class="co">#&gt; outer mgc:  4.235342 </span></span>
<span><span class="co">#&gt; outer mgc:  1.269788 </span></span>
<span><span class="co">#&gt; outer mgc:  1.26059 </span></span>
<span><span class="co">#&gt; outer mgc:  0.1602757 </span></span>
<span><span class="co">#&gt; outer mgc:  0.1689924 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2793749 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2879054 </span></span>
<span><span class="co">#&gt; outer mgc:  4.210347 </span></span>
<span><span class="co">#&gt; outer mgc:  4.217273 </span></span>
<span><span class="co">#&gt; outer mgc:  3.418461 </span></span>
<span><span class="co">#&gt; outer mgc:  3.425712 </span></span>
<span><span class="co">#&gt; outer mgc:  3.231905 </span></span>
<span><span class="co">#&gt; outer mgc:  3.238845 </span></span>
<span><span class="co">#&gt; outer mgc:  1.485523 </span></span>
<span><span class="co">#&gt; outer mgc:  1.492818 </span></span>
<span><span class="co">#&gt; outer mgc:  0.03014799 </span></span>
<span><span class="co">#&gt; outer mgc:  0.03878761 </span></span>
<span><span class="co">#&gt; outer mgc:  3.449243 </span></span>
<span><span class="co">#&gt; outer mgc:  3.456659 </span></span>
<span><span class="co">#&gt; outer mgc:  2.654402 </span></span>
<span><span class="co">#&gt; outer mgc:  2.663017 </span></span>
<span><span class="co">#&gt; outer mgc:  1.170511 </span></span>
<span><span class="co">#&gt; outer mgc:  1.178269 </span></span>
<span><span class="co">#&gt; outer mgc:  3.431326 </span></span>
<span><span class="co">#&gt; outer mgc:  3.438881 </span></span>
<span><span class="co">#&gt; outer mgc:  3.826702 </span></span>
<span><span class="co">#&gt; outer mgc:  3.834084 </span></span>
<span><span class="co">#&gt; outer mgc:  0.7321207 </span></span>
<span><span class="co">#&gt; outer mgc:  0.7403002 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2869731 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2781079 </span></span>
<span><span class="co">#&gt; outer mgc:  0.534149 </span></span>
<span><span class="co">#&gt; outer mgc:  0.533641 </span></span>
<span><span class="co">#&gt; outer mgc:  5.02214 </span></span>
<span><span class="co">#&gt; outer mgc:  5.028657 </span></span>
<span><span class="co">#&gt; outer mgc:  3.232242 </span></span>
<span><span class="co">#&gt; outer mgc:  3.239931 </span></span>
<span><span class="co">#&gt; outer mgc:  5.141045 </span></span>
<span><span class="co">#&gt; outer mgc:  5.149744 </span></span>
<span><span class="co">#&gt; outer mgc:  0.6797956 </span></span>
<span><span class="co">#&gt; outer mgc:  0.6877959 </span></span>
<span><span class="co">#&gt; outer mgc:  3.707248 </span></span>
<span><span class="co">#&gt; outer mgc:  3.713102 </span></span>
<span><span class="co">#&gt; outer mgc:  1.021464 </span></span>
<span><span class="co">#&gt; outer mgc:  1.029395 </span></span>
<span><span class="co">#&gt; outer mgc:  5.777527 </span></span>
<span><span class="co">#&gt; outer mgc:  5.785581 </span></span>
<span><span class="co">#&gt; outer mgc:  4.672922 </span></span>
<span><span class="co">#&gt; outer mgc:  4.680312 </span></span>
<span><span class="co">#&gt; outer mgc:  2.90907 </span></span>
<span><span class="co">#&gt; outer mgc:  2.916638 </span></span>
<span><span class="co">#&gt; outer mgc:  0.365279 </span></span>
<span><span class="co">#&gt; outer mgc:  0.3647707 </span></span>
<span><span class="co">#&gt; outer mgc:  0.9003662 </span></span>
<span><span class="co">#&gt; outer mgc:  0.8917907 </span></span>
<span><span class="co">#&gt; outer mgc:  1.173995 </span></span>
<span><span class="co">#&gt; outer mgc:  1.182997 </span></span>
<span><span class="co">#&gt; outer mgc:  2.05739 </span></span>
<span><span class="co">#&gt; outer mgc:  2.065826 </span></span>
<span><span class="co">#&gt; outer mgc:  5.806499 </span></span>
<span><span class="co">#&gt; outer mgc:  5.811626 </span></span>
<span><span class="co">#&gt; outer mgc:  3.949455 </span></span>
<span><span class="co">#&gt; outer mgc:  3.955025 </span></span>
<span><span class="co">#&gt; outer mgc:  12.19535 </span></span>
<span><span class="co">#&gt; outer mgc:  12.19761 </span></span>
<span><span class="co">#&gt; outer mgc:  7.179361 </span></span>
<span><span class="co">#&gt; outer mgc:  7.183645 </span></span>
<span><span class="co">#&gt; outer mgc:  1.687254 </span></span>
<span><span class="co">#&gt; outer mgc:  1.694403 </span></span>
<span><span class="co">#&gt; outer mgc:  10.89529 </span></span>
<span><span class="co">#&gt; outer mgc:  10.89907 </span></span>
<span><span class="co">#&gt; outer mgc:  6.895265 </span></span>
<span><span class="co">#&gt; outer mgc:  6.904303 </span></span>
<span><span class="co">#&gt; outer mgc:  6.129483 </span></span>
<span><span class="co">#&gt; outer mgc:  6.139513 </span></span>
<span><span class="co">#&gt; outer mgc:  4.238807 </span></span>
<span><span class="co">#&gt; outer mgc:  4.247339 </span></span>
<span><span class="co">#&gt; outer mgc:  8.229423 </span></span>
<span><span class="co">#&gt; outer mgc:  8.235519 </span></span>
<span><span class="co">#&gt; outer mgc:  4.238125 </span></span>
<span><span class="co">#&gt; outer mgc:  4.253632 </span></span>
<span><span class="co">#&gt; outer mgc:  5.644065 </span></span>
<span><span class="co">#&gt; outer mgc:  5.658952 </span></span>
<span><span class="co">#&gt; outer mgc:  5.729872 </span></span>
<span><span class="co">#&gt; outer mgc:  5.738978 </span></span>
<span><span class="co">#&gt; outer mgc:  5.5304 </span></span>
<span><span class="co">#&gt; outer mgc:  5.53613 </span></span>
<span><span class="co">#&gt; outer mgc:  1.420927 </span></span>
<span><span class="co">#&gt; outer mgc:  1.419385 </span></span>
<span><span class="co">#&gt; outer mgc:  1.021527 </span></span>
<span><span class="co">#&gt; outer mgc:  1.020361 </span></span>
<span><span class="co">#&gt; outer mgc:  3.467399 </span></span>
<span><span class="co">#&gt; outer mgc:  3.475509 </span></span>
<span><span class="co">#&gt; outer mgc:  1.75704 </span></span>
<span><span class="co">#&gt; outer mgc:  1.764413 </span></span>
<span><span class="co">#&gt; outer mgc:  1.904011 </span></span>
<span><span class="co">#&gt; outer mgc:  1.903157 </span></span>
<span><span class="co">#&gt; outer mgc:  1.729504 </span></span>
<span><span class="co">#&gt; outer mgc:  1.737387 </span></span>
<span><span class="co">#&gt; outer mgc:  1.751945 </span></span>
<span><span class="co">#&gt; outer mgc:  1.760472 </span></span>
<span><span class="co">#&gt; outer mgc:  2.814279 </span></span>
<span><span class="co">#&gt; outer mgc:  2.820074 </span></span>
<span><span class="co">#&gt; outer mgc:  0.8553941 </span></span>
<span><span class="co">#&gt; outer mgc:  0.8702851 </span></span>
<span><span class="co">#&gt; outer mgc:  3.500682 </span></span>
<span><span class="co">#&gt; outer mgc:  3.506494 </span></span>
<span><span class="co">#&gt; outer mgc:  2.521176 </span></span>
<span><span class="co">#&gt; outer mgc:  2.527995 </span></span>
<span><span class="co">#&gt; outer mgc:  9.111923 </span></span>
<span><span class="co">#&gt; outer mgc:  9.115014 </span></span>
<span><span class="co">#&gt; outer mgc:  6.639502 </span></span>
<span><span class="co">#&gt; outer mgc:  6.645803 </span></span>
<span><span class="co">#&gt; outer mgc:  12.88614 </span></span>
<span><span class="co">#&gt; outer mgc:  12.89845 </span></span>
<span><span class="co">#&gt; outer mgc:  5.108365 </span></span>
<span><span class="co">#&gt; outer mgc:  5.113859 </span></span>
<span><span class="co">#&gt; outer mgc:  16.91788 </span></span>
<span><span class="co">#&gt; outer mgc:  16.93175 </span></span>
<span><span class="co">#&gt; outer mgc:  10.49986 </span></span>
<span><span class="co">#&gt; outer mgc:  10.51043 </span></span>
<span><span class="co">#&gt; outer mgc:  5.663252 </span></span>
<span><span class="co">#&gt; outer mgc:  5.671446 </span></span>
<span><span class="co">#&gt; outer mgc:  10.29829 </span></span>
<span><span class="co">#&gt; outer mgc:  10.31092 </span></span>
<span><span class="co">#&gt; outer mgc:  20.44487 </span></span>
<span><span class="co">#&gt; outer mgc:  20.47198 </span></span>
<span><span class="co">#&gt; outer mgc:  32.53067 </span></span>
<span><span class="co">#&gt; outer mgc:  32.64424 </span></span>
<span><span class="co">#&gt; outer mgc:  24.96574 </span></span>
<span><span class="co">#&gt; outer mgc:  25.04215 </span></span>
<span><span class="co">#&gt; outer mgc:  3.502075 </span></span>
<span><span class="co">#&gt; outer mgc:  3.508773 </span></span>
<span><span class="co">#&gt; outer mgc:  1.509922 </span></span>
<span><span class="co">#&gt; outer mgc:  1.523144 </span></span>
<span><span class="co">#&gt; outer mgc:  13.79697 </span></span>
<span><span class="co">#&gt; outer mgc:  13.78667 </span></span>
<span><span class="co">#&gt; outer mgc:  0.08873179 </span></span>
<span><span class="co">#&gt; outer mgc:  0.07998254 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007797128 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007797128</span></span></code></pre></div>
<p>Look for any parameters with high correlations (absolute correlation
&gt; 0.95) using the <code>get_cor_pairs</code> function:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_cor_pairs.html">get_cor_pairs</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">obj</span>, threshold <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "No pairs show strong positive or negative correlation relative to 0.95 threshold."</span></span></code></pre></div>
<p>Calculate standard deviations of all model parameters:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Report</span> <span class="op">&lt;-</span> <span class="fu">sdreport</span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span>
<span><span class="co">#&gt; outer mgc:  0.007797127 </span></span>
<span><span class="co">#&gt; outer mgc:  347.4191 </span></span>
<span><span class="co">#&gt; outer mgc:  351.1383 </span></span>
<span><span class="co">#&gt; outer mgc:  7.425739 </span></span>
<span><span class="co">#&gt; outer mgc:  7.425739 </span></span>
<span><span class="co">#&gt; outer mgc:  3890.009 </span></span>
<span><span class="co">#&gt; outer mgc:  8195.903 </span></span>
<span><span class="co">#&gt; outer mgc:  465.0801 </span></span>
<span><span class="co">#&gt; outer mgc:  992.6296 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00779724 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007797017 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007934167 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007662319 </span></span>
<span><span class="co">#&gt; outer mgc:  58.15492 </span></span>
<span><span class="co">#&gt; outer mgc:  58.12802 </span></span>
<span><span class="co">#&gt; outer mgc:  21.19234 </span></span>
<span><span class="co">#&gt; outer mgc:  21.20837 </span></span>
<span><span class="co">#&gt; outer mgc:  0.3042917 </span></span>
<span><span class="co">#&gt; outer mgc:  0.3039646 </span></span>
<span><span class="co">#&gt; outer mgc:  0.0168823 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01686519 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01673788 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01672092 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01686756 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01685045 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01659518 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01657792 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01697672 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01695944 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01684651 </span></span>
<span><span class="co">#&gt; outer mgc:  0.0168294 </span></span>
<span><span class="co">#&gt; outer mgc:  0.0165236 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01650681 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01566827 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01565199 </span></span>
<span><span class="co">#&gt; outer mgc:  0.015449 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01543328 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01504047 </span></span>
<span><span class="co">#&gt; outer mgc:  0.0150252 </span></span>
<span><span class="co">#&gt; outer mgc:  0.271319 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2710141 </span></span>
<span><span class="co">#&gt; outer mgc:  0.0143702 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01435541 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01477368 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01475858 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01492106 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01490585 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01501283 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01499748 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01417652 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01416134 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01457219 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01455715 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01406494 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01405043 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01329361 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01327982 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01163089 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01161816 </span></span>
<span><span class="co">#&gt; outer mgc:  0.0114122 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01140017 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01065472 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01064346 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009949407 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009938796 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008817778 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008807932 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009066733 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008503312 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009179949 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008414484 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009271946 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008575734 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009265323 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008580709 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009427784 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008858965 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009508113 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009003823 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009652928 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00926113 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009849682 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009615703 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01033174 </span></span>
<span><span class="co">#&gt; outer mgc:  0.010207 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01088821 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01076297 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01113734 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01101186 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01090837 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01078305 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01053753 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01041259 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01012187 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00999739 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009849496 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009645841 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009738101 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009458365 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009748011 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009479297 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009835656 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009633935 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01010983 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009985377 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01065228 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01052723 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01144435 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01131856 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01190145 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01177527 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01184947 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01172335 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01160906 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01148312 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01125066 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01112508 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01067919 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01055419 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01017753 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01005302 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009914762 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00966156 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009745639 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009341869 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00956059 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00899242 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009435119 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008745897 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009423527 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008694951 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009580175 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00892421 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009838855 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009318922 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01016868 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009827112 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01032978 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01005826 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01020348 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009793525 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009704892 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008910153 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009153944 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00795618 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008720043 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007465795 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008521329 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007480718 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008496089 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007482545 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008614105 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007473548 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008929922 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00744955 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009489634 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008212525 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01011798 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009152219 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01064516 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009932563 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01096953 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01039584 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01079453 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01007328 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01012761 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008993946 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009442102 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007903338 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008907146 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007450101 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008542685 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007477635 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008301649 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007495837 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008198832 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007503592 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008260478 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007498871 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008478382 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007482322 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008796794 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007458264 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009209696 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007927082 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009648842 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008455333 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01006153 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008871859 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01029942 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009005262 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01034388 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008962654 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01021663 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008741177 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009941929 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008296411 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009642196 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007816099 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009506909 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007578715 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009597869 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007670362 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009873071 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008044975 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01008183 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008619414 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009956648 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008895553 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009401577 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008554835 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008913837 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008250284 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008534289 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008027432 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008320723 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008047212 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00820206 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008195192 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008433278 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008426301 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008300722 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008293873 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008041757 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007840537 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008012135 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007582335 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007989294 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00760515 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007968397 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007626025 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007952011 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007642396 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007939502 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007654896 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007933779 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00766061 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007928972 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007665411 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007924016 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007670363 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007915784 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007678588 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007902178 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007692183 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007879573 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007714767 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007849955 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007744359 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007816303 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00777798 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007781992 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00781226 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007748696 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007845526 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007716073 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00787812 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007684534 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007909628 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007648952 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007945178 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007611636 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007982462 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007571233 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008022832 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007530986 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008063037 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007478699 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008115283 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007418096 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008175841 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007354256 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008239624 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007285163 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008308651 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007194915 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008398823 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007076828 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008516815 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00691879 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008674713 </span></span>
<span><span class="co">#&gt; outer mgc:  0.006698457 </span></span>
<span><span class="co">#&gt; outer mgc:  0.008894824 </span></span>
<span><span class="co">#&gt; outer mgc:  0.006344087 </span></span>
<span><span class="co">#&gt; outer mgc:  0.00924886 </span></span>
<span><span class="co">#&gt; outer mgc:  0.005756287 </span></span>
<span><span class="co">#&gt; outer mgc:  0.009836135 </span></span>
<span><span class="co">#&gt; outer mgc:  0.004808432 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01078313 </span></span>
<span><span class="co">#&gt; outer mgc:  0.004274963 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01214914 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007448901 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01610319 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01388222 </span></span>
<span><span class="co">#&gt; outer mgc:  0.02253104 </span></span>
<span><span class="co">#&gt; outer mgc:  0.02339296 </span></span>
<span><span class="co">#&gt; outer mgc:  0.03203203 </span></span>
<span><span class="co">#&gt; outer mgc:  0.03498395 </span></span>
<span><span class="co">#&gt; outer mgc:  0.04360542 </span></span>
<span><span class="co">#&gt; outer mgc:  0.05541214 </span></span>
<span><span class="co">#&gt; outer mgc:  0.06401444 </span></span>
<span><span class="co">#&gt; outer mgc:  0.7409086 </span></span>
<span><span class="co">#&gt; outer mgc:  0.7490625 </span></span>
<span><span class="co">#&gt; outer mgc:  2.155005 </span></span>
<span><span class="co">#&gt; outer mgc:  2.162579 </span></span>
<span><span class="co">#&gt; outer mgc:  0.0780389 </span></span>
<span><span class="co">#&gt; outer mgc:  0.08662286 </span></span>
<span><span class="co">#&gt; outer mgc:  0.5778662 </span></span>
<span><span class="co">#&gt; outer mgc:  0.5856053 </span></span>
<span><span class="co">#&gt; outer mgc:  0.823831 </span></span>
<span><span class="co">#&gt; outer mgc:  0.8319971 </span></span>
<span><span class="co">#&gt; outer mgc:  0.1034709 </span></span>
<span><span class="co">#&gt; outer mgc:  0.1120505 </span></span>
<span><span class="co">#&gt; outer mgc:  0.1219531 </span></span>
<span><span class="co">#&gt; outer mgc:  0.1132092 </span></span>
<span><span class="co">#&gt; outer mgc:  1.482771 </span></span>
<span><span class="co">#&gt; outer mgc:  1.474451 </span></span>
<span><span class="co">#&gt; outer mgc:  0.8202699 </span></span>
<span><span class="co">#&gt; outer mgc:  0.8111862 </span></span>
<span><span class="co">#&gt; outer mgc:  0.3926228 </span></span>
<span><span class="co">#&gt; outer mgc:  0.4015062 </span></span>
<span><span class="co">#&gt; outer mgc:  0.06491398 </span></span>
<span><span class="co">#&gt; outer mgc:  0.07351285 </span></span>
<span><span class="co">#&gt; outer mgc:  1.112738 </span></span>
<span><span class="co">#&gt; outer mgc:  1.10396 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2938432 </span></span>
<span><span class="co">#&gt; outer mgc:  0.3022028 </span></span>
<span><span class="co">#&gt; outer mgc:  6.878406 </span></span>
<span><span class="co">#&gt; outer mgc:  6.886027 </span></span>
<span><span class="co">#&gt; outer mgc:  0.1274339 </span></span>
<span><span class="co">#&gt; outer mgc:  0.135969 </span></span>
<span><span class="co">#&gt; outer mgc:  1.185186 </span></span>
<span><span class="co">#&gt; outer mgc:  1.176758 </span></span>
<span><span class="co">#&gt; outer mgc:  1.516421 </span></span>
<span><span class="co">#&gt; outer mgc:  1.506853 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2779635 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2864332 </span></span>
<span><span class="co">#&gt; outer mgc:  0.6787312 </span></span>
<span><span class="co">#&gt; outer mgc:  0.6870031 </span></span>
<span><span class="co">#&gt; outer mgc:  0.5495213 </span></span>
<span><span class="co">#&gt; outer mgc:  0.5577572 </span></span>
<span><span class="co">#&gt; outer mgc:  0.7441101 </span></span>
<span><span class="co">#&gt; outer mgc:  0.7526542 </span></span>
<span><span class="co">#&gt; outer mgc:  0.3949633 </span></span>
<span><span class="co">#&gt; outer mgc:  0.4031617 </span></span>
<span><span class="co">#&gt; outer mgc:  0.06054796 </span></span>
<span><span class="co">#&gt; outer mgc:  0.06918406 </span></span>
<span><span class="co">#&gt; outer mgc:  0.4957229 </span></span>
<span><span class="co">#&gt; outer mgc:  0.5051172 </span></span>
<span><span class="co">#&gt; outer mgc:  0.7263806 </span></span>
<span><span class="co">#&gt; outer mgc:  0.717226 </span></span>
<span><span class="co">#&gt; outer mgc:  0.07382071 </span></span>
<span><span class="co">#&gt; outer mgc:  0.06499597 </span></span>
<span><span class="co">#&gt; outer mgc:  0.6017272 </span></span>
<span><span class="co">#&gt; outer mgc:  0.6095504 </span></span>
<span><span class="co">#&gt; outer mgc:  0.5534599 </span></span>
<span><span class="co">#&gt; outer mgc:  0.5616554 </span></span>
<span><span class="co">#&gt; outer mgc:  1.299205 </span></span>
<span><span class="co">#&gt; outer mgc:  1.306803 </span></span>
<span><span class="co">#&gt; outer mgc:  0.1917466 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2002726 </span></span>
<span><span class="co">#&gt; outer mgc:  5.573434 </span></span>
<span><span class="co">#&gt; outer mgc:  5.57941 </span></span>
<span><span class="co">#&gt; outer mgc:  0.07006612 </span></span>
<span><span class="co">#&gt; outer mgc:  0.07865649 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2460567 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2456817 </span></span>
<span><span class="co">#&gt; outer mgc:  1.116152 </span></span>
<span><span class="co">#&gt; outer mgc:  1.123396 </span></span>
<span><span class="co">#&gt; outer mgc:  0.5795667 </span></span>
<span><span class="co">#&gt; outer mgc:  0.5788785 </span></span>
<span><span class="co">#&gt; outer mgc:  1.205114 </span></span>
<span><span class="co">#&gt; outer mgc:  1.204542 </span></span>
<span><span class="co">#&gt; outer mgc:  0.4451883 </span></span>
<span><span class="co">#&gt; outer mgc:  0.4535981 </span></span>
<span><span class="co">#&gt; outer mgc:  0.972637 </span></span>
<span><span class="co">#&gt; outer mgc:  0.9818465 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01533162 </span></span>
<span><span class="co">#&gt; outer mgc:  0.01736746 </span></span>
<span><span class="co">#&gt; outer mgc:  2.780024 </span></span>
<span><span class="co">#&gt; outer mgc:  2.769304 </span></span>
<span><span class="co">#&gt; outer mgc:  3.014167 </span></span>
<span><span class="co">#&gt; outer mgc:  3.00493 </span></span>
<span><span class="co">#&gt; outer mgc:  7.589536 </span></span>
<span><span class="co">#&gt; outer mgc:  7.593513 </span></span>
<span><span class="co">#&gt; outer mgc:  10.92017 </span></span>
<span><span class="co">#&gt; outer mgc:  10.92508 </span></span>
<span><span class="co">#&gt; outer mgc:  3.536842 </span></span>
<span><span class="co">#&gt; outer mgc:  3.543199 </span></span>
<span><span class="co">#&gt; outer mgc:  0.3038261 </span></span>
<span><span class="co">#&gt; outer mgc:  0.3123261 </span></span>
<span><span class="co">#&gt; outer mgc:  0.1715483 </span></span>
<span><span class="co">#&gt; outer mgc:  0.1626341 </span></span>
<span><span class="co">#&gt; outer mgc:  0.8782286 </span></span>
<span><span class="co">#&gt; outer mgc:  0.8691346 </span></span>
<span><span class="co">#&gt; outer mgc:  1.522929 </span></span>
<span><span class="co">#&gt; outer mgc:  1.521785 </span></span>
<span><span class="co">#&gt; outer mgc:  2.87275 </span></span>
<span><span class="co">#&gt; outer mgc:  2.882766 </span></span>
<span><span class="co">#&gt; outer mgc:  1.06335 </span></span>
<span><span class="co">#&gt; outer mgc:  1.06258 </span></span>
<span><span class="co">#&gt; outer mgc:  1.234482 </span></span>
<span><span class="co">#&gt; outer mgc:  1.2246 </span></span>
<span><span class="co">#&gt; outer mgc:  8.521876 </span></span>
<span><span class="co">#&gt; outer mgc:  8.525912 </span></span>
<span><span class="co">#&gt; outer mgc:  6.759704 </span></span>
<span><span class="co">#&gt; outer mgc:  6.764074 </span></span>
<span><span class="co">#&gt; outer mgc:  1.841253 </span></span>
<span><span class="co">#&gt; outer mgc:  1.848631 </span></span>
<span><span class="co">#&gt; outer mgc:  4.00754 </span></span>
<span><span class="co">#&gt; outer mgc:  3.996792 </span></span>
<span><span class="co">#&gt; outer mgc:  4.249127 </span></span>
<span><span class="co">#&gt; outer mgc:  4.235342 </span></span>
<span><span class="co">#&gt; outer mgc:  1.269788 </span></span>
<span><span class="co">#&gt; outer mgc:  1.26059 </span></span>
<span><span class="co">#&gt; outer mgc:  0.1602757 </span></span>
<span><span class="co">#&gt; outer mgc:  0.1689924 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2793749 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2879054 </span></span>
<span><span class="co">#&gt; outer mgc:  4.210347 </span></span>
<span><span class="co">#&gt; outer mgc:  4.217273 </span></span>
<span><span class="co">#&gt; outer mgc:  3.418461 </span></span>
<span><span class="co">#&gt; outer mgc:  3.425712 </span></span>
<span><span class="co">#&gt; outer mgc:  3.231905 </span></span>
<span><span class="co">#&gt; outer mgc:  3.238845 </span></span>
<span><span class="co">#&gt; outer mgc:  1.485523 </span></span>
<span><span class="co">#&gt; outer mgc:  1.492818 </span></span>
<span><span class="co">#&gt; outer mgc:  0.03014799 </span></span>
<span><span class="co">#&gt; outer mgc:  0.03878761 </span></span>
<span><span class="co">#&gt; outer mgc:  3.449243 </span></span>
<span><span class="co">#&gt; outer mgc:  3.456659 </span></span>
<span><span class="co">#&gt; outer mgc:  2.654402 </span></span>
<span><span class="co">#&gt; outer mgc:  2.663017 </span></span>
<span><span class="co">#&gt; outer mgc:  1.170511 </span></span>
<span><span class="co">#&gt; outer mgc:  1.178269 </span></span>
<span><span class="co">#&gt; outer mgc:  3.431326 </span></span>
<span><span class="co">#&gt; outer mgc:  3.438881 </span></span>
<span><span class="co">#&gt; outer mgc:  3.826702 </span></span>
<span><span class="co">#&gt; outer mgc:  3.834084 </span></span>
<span><span class="co">#&gt; outer mgc:  0.7321207 </span></span>
<span><span class="co">#&gt; outer mgc:  0.7403002 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2869731 </span></span>
<span><span class="co">#&gt; outer mgc:  0.2781079 </span></span>
<span><span class="co">#&gt; outer mgc:  0.534149 </span></span>
<span><span class="co">#&gt; outer mgc:  0.533641 </span></span>
<span><span class="co">#&gt; outer mgc:  5.02214 </span></span>
<span><span class="co">#&gt; outer mgc:  5.028657 </span></span>
<span><span class="co">#&gt; outer mgc:  3.232242 </span></span>
<span><span class="co">#&gt; outer mgc:  3.239931 </span></span>
<span><span class="co">#&gt; outer mgc:  5.141045 </span></span>
<span><span class="co">#&gt; outer mgc:  5.149744 </span></span>
<span><span class="co">#&gt; outer mgc:  0.6797956 </span></span>
<span><span class="co">#&gt; outer mgc:  0.6877959 </span></span>
<span><span class="co">#&gt; outer mgc:  3.707248 </span></span>
<span><span class="co">#&gt; outer mgc:  3.713102 </span></span>
<span><span class="co">#&gt; outer mgc:  1.021464 </span></span>
<span><span class="co">#&gt; outer mgc:  1.029395 </span></span>
<span><span class="co">#&gt; outer mgc:  5.777527 </span></span>
<span><span class="co">#&gt; outer mgc:  5.785581 </span></span>
<span><span class="co">#&gt; outer mgc:  4.672922 </span></span>
<span><span class="co">#&gt; outer mgc:  4.680312 </span></span>
<span><span class="co">#&gt; outer mgc:  2.90907 </span></span>
<span><span class="co">#&gt; outer mgc:  2.916638 </span></span>
<span><span class="co">#&gt; outer mgc:  0.365279 </span></span>
<span><span class="co">#&gt; outer mgc:  0.3647707 </span></span>
<span><span class="co">#&gt; outer mgc:  0.9003662 </span></span>
<span><span class="co">#&gt; outer mgc:  0.8917907 </span></span>
<span><span class="co">#&gt; outer mgc:  1.173995 </span></span>
<span><span class="co">#&gt; outer mgc:  1.182997 </span></span>
<span><span class="co">#&gt; outer mgc:  2.05739 </span></span>
<span><span class="co">#&gt; outer mgc:  2.065826 </span></span>
<span><span class="co">#&gt; outer mgc:  5.806499 </span></span>
<span><span class="co">#&gt; outer mgc:  5.811626 </span></span>
<span><span class="co">#&gt; outer mgc:  3.949455 </span></span>
<span><span class="co">#&gt; outer mgc:  3.955025 </span></span>
<span><span class="co">#&gt; outer mgc:  12.19535 </span></span>
<span><span class="co">#&gt; outer mgc:  12.19761 </span></span>
<span><span class="co">#&gt; outer mgc:  7.179361 </span></span>
<span><span class="co">#&gt; outer mgc:  7.183645 </span></span>
<span><span class="co">#&gt; outer mgc:  1.687254 </span></span>
<span><span class="co">#&gt; outer mgc:  1.694403 </span></span>
<span><span class="co">#&gt; outer mgc:  10.89529 </span></span>
<span><span class="co">#&gt; outer mgc:  10.89907 </span></span>
<span><span class="co">#&gt; outer mgc:  6.895265 </span></span>
<span><span class="co">#&gt; outer mgc:  6.904303 </span></span>
<span><span class="co">#&gt; outer mgc:  6.129483 </span></span>
<span><span class="co">#&gt; outer mgc:  6.139513 </span></span>
<span><span class="co">#&gt; outer mgc:  4.238807 </span></span>
<span><span class="co">#&gt; outer mgc:  4.247339 </span></span>
<span><span class="co">#&gt; outer mgc:  8.229423 </span></span>
<span><span class="co">#&gt; outer mgc:  8.235519 </span></span>
<span><span class="co">#&gt; outer mgc:  4.238125 </span></span>
<span><span class="co">#&gt; outer mgc:  4.253632 </span></span>
<span><span class="co">#&gt; outer mgc:  5.644065 </span></span>
<span><span class="co">#&gt; outer mgc:  5.658952 </span></span>
<span><span class="co">#&gt; outer mgc:  5.729872 </span></span>
<span><span class="co">#&gt; outer mgc:  5.738978 </span></span>
<span><span class="co">#&gt; outer mgc:  5.5304 </span></span>
<span><span class="co">#&gt; outer mgc:  5.53613 </span></span>
<span><span class="co">#&gt; outer mgc:  1.420927 </span></span>
<span><span class="co">#&gt; outer mgc:  1.419385 </span></span>
<span><span class="co">#&gt; outer mgc:  1.021527 </span></span>
<span><span class="co">#&gt; outer mgc:  1.020361 </span></span>
<span><span class="co">#&gt; outer mgc:  3.467399 </span></span>
<span><span class="co">#&gt; outer mgc:  3.475509 </span></span>
<span><span class="co">#&gt; outer mgc:  1.75704 </span></span>
<span><span class="co">#&gt; outer mgc:  1.764413 </span></span>
<span><span class="co">#&gt; outer mgc:  1.904011 </span></span>
<span><span class="co">#&gt; outer mgc:  1.903157 </span></span>
<span><span class="co">#&gt; outer mgc:  1.729504 </span></span>
<span><span class="co">#&gt; outer mgc:  1.737387 </span></span>
<span><span class="co">#&gt; outer mgc:  1.751945 </span></span>
<span><span class="co">#&gt; outer mgc:  1.760472 </span></span>
<span><span class="co">#&gt; outer mgc:  2.814279 </span></span>
<span><span class="co">#&gt; outer mgc:  2.820074 </span></span>
<span><span class="co">#&gt; outer mgc:  0.8553941 </span></span>
<span><span class="co">#&gt; outer mgc:  0.8702851 </span></span>
<span><span class="co">#&gt; outer mgc:  3.500682 </span></span>
<span><span class="co">#&gt; outer mgc:  3.506494 </span></span>
<span><span class="co">#&gt; outer mgc:  2.521176 </span></span>
<span><span class="co">#&gt; outer mgc:  2.527995 </span></span>
<span><span class="co">#&gt; outer mgc:  9.111923 </span></span>
<span><span class="co">#&gt; outer mgc:  9.115014 </span></span>
<span><span class="co">#&gt; outer mgc:  6.639502 </span></span>
<span><span class="co">#&gt; outer mgc:  6.645803 </span></span>
<span><span class="co">#&gt; outer mgc:  12.88614 </span></span>
<span><span class="co">#&gt; outer mgc:  12.89845 </span></span>
<span><span class="co">#&gt; outer mgc:  5.108365 </span></span>
<span><span class="co">#&gt; outer mgc:  5.113859 </span></span>
<span><span class="co">#&gt; outer mgc:  16.91788 </span></span>
<span><span class="co">#&gt; outer mgc:  16.93175 </span></span>
<span><span class="co">#&gt; outer mgc:  10.49986 </span></span>
<span><span class="co">#&gt; outer mgc:  10.51043 </span></span>
<span><span class="co">#&gt; outer mgc:  5.663252 </span></span>
<span><span class="co">#&gt; outer mgc:  5.671446 </span></span>
<span><span class="co">#&gt; outer mgc:  10.29829 </span></span>
<span><span class="co">#&gt; outer mgc:  10.31092 </span></span>
<span><span class="co">#&gt; outer mgc:  20.44487 </span></span>
<span><span class="co">#&gt; outer mgc:  20.47198 </span></span>
<span><span class="co">#&gt; outer mgc:  32.53067 </span></span>
<span><span class="co">#&gt; outer mgc:  32.64424 </span></span>
<span><span class="co">#&gt; outer mgc:  24.96574 </span></span>
<span><span class="co">#&gt; outer mgc:  25.04215 </span></span>
<span><span class="co">#&gt; outer mgc:  3.502075 </span></span>
<span><span class="co">#&gt; outer mgc:  3.508773 </span></span>
<span><span class="co">#&gt; outer mgc:  1.509922 </span></span>
<span><span class="co">#&gt; outer mgc:  1.523144 </span></span>
<span><span class="co">#&gt; outer mgc:  13.79697 </span></span>
<span><span class="co">#&gt; outer mgc:  13.78667 </span></span>
<span><span class="co">#&gt; outer mgc:  0.08873179 </span></span>
<span><span class="co">#&gt; outer mgc:  0.07998254 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007797128 </span></span>
<span><span class="co">#&gt; outer mgc:  0.007797128</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-fits">Data fits<a class="anchor" aria-label="anchor" href="#data-fits"></a>
</h3>
<p>Inspect predicted vs observed length compositions:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lf_rep</span> <span class="op">&lt;-</span> <span class="va">obj</span><span class="op">$</span><span class="fu">report</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">lf_pred</span> <span class="op">&lt;-</span> <span class="va">lf_rep</span><span class="op">$</span><span class="va">lf_pred</span></span>
<span><span class="va">nbins</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">lf_maxbin</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">data</span><span class="op">$</span><span class="va">lf_minbin</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># Name the list elements and columns</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">lf_pred</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">lf_fishery_f</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">lf_pred</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">lf_pred</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">len_mid</span></span>
<span></span>
<span><span class="co"># Helper: convert a flat OBS vector back to list-of-matrices (proportions)</span></span>
<span><span class="va">flat_to_list</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">v</span>, <span class="va">lf_n_f</span>, <span class="va">nbins</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lf_n_f</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">offset</span> <span class="op">&lt;-</span> <span class="fl">0L</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">lf_n_f</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">v</span><span class="op">[</span><span class="op">(</span><span class="va">offset</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">offset</span> <span class="op">+</span> <span class="va">lf_n_f</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">*</span> <span class="va">nbins</span><span class="op">)</span><span class="op">]</span>, nrow <span class="op">=</span> <span class="va">lf_n_f</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>, ncol <span class="op">=</span> <span class="va">nbins</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="co"># Normalise each row to proportions</span></span>
<span>    <span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span>    <span class="va">rs</span><span class="op">[</span><span class="va">rs</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>    <span class="va">out</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">m</span> <span class="op">/</span> <span class="va">rs</span></span>
<span>    <span class="va">offset</span> <span class="op">&lt;-</span> <span class="va">offset</span> <span class="op">+</span> <span class="va">lf_n_f</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">*</span> <span class="va">nbins</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">out</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Split year index by fishery (must match length of lf_year)</span></span>
<span><span class="va">lf_year_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">lf_year</span>, <span class="va">data</span><span class="op">$</span><span class="va">lf_fishery</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Predicted: long data frame ----</span></span>
<span><span class="va">df_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">lf_pred</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">m</span> <span class="op">&lt;-</span> <span class="va">lf_pred</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">yrs</span> <span class="op">&lt;-</span> <span class="va">lf_year_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">as.data.frame.table</a></span><span class="op">(</span><span class="va">m</span>, responseName <span class="op">=</span> <span class="st">"pred"</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">Var1</span>, length <span class="op">=</span> <span class="va">Var2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>fishery <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">lf_pred</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>           id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">id</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           year <span class="op">=</span> <span class="va">yrs</span><span class="op">[</span><span class="va">id</span><span class="op">]</span>,</span>
<span>           length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">length</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Observed: long data frame ----</span></span>
<span><span class="va">df_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">lf_obs_in</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_obs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">len_mid</span></span>
<span><span class="va">df_obs</span> <span class="op">&lt;-</span> <span class="va">df_obs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">lf_year</span>, fishery <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">lf_fishery</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">fishery</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">fishery</span>, <span class="va">id</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"length"</span>, values_to <span class="op">=</span> <span class="st">"obs"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">length</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Simulations: generate n_sim draws and convert to long format ----</span></span>
<span><span class="va">n_sim</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">df_sim_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_sim</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Determine which OBS vector was active based on lf_switch</span></span>
<span>  <span class="va">sim</span> <span class="op">&lt;-</span> <span class="va">obj</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">lf_switch</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">sim_vec</span> <span class="op">&lt;-</span> <span class="va">sim</span><span class="op">$</span><span class="va">lf_obs_flat</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">lf_switch</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">sim_vec</span> <span class="op">&lt;-</span> <span class="va">sim</span><span class="op">$</span><span class="va">lf_obs_prop</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">sim_vec</span> <span class="op">&lt;-</span> <span class="va">sim</span><span class="op">$</span><span class="va">lf_obs_ints</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">sim_list</span> <span class="op">&lt;-</span> <span class="fu">flat_to_list</span><span class="op">(</span><span class="va">sim_vec</span>, <span class="va">data</span><span class="op">$</span><span class="va">lf_n_f</span>, <span class="va">nbins</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sim_list</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">lf_fishery_f</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">sim_list</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sim_list</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">len_mid</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">sim_list</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">m</span> <span class="op">&lt;-</span> <span class="va">sim_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">yrs</span> <span class="op">&lt;-</span> <span class="va">lf_year_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">as.data.frame.table</a></span><span class="op">(</span><span class="va">m</span>, responseName <span class="op">=</span> <span class="st">"sim"</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">Var1</span>, length <span class="op">=</span> <span class="va">Var2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>fishery <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sim_list</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>             id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">id</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             year <span class="op">=</span> <span class="va">yrs</span><span class="op">[</span><span class="va">id</span><span class="op">]</span>,</span>
<span>             length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">length</span><span class="op">)</span>,</span>
<span>             sim_id <span class="op">=</span> <span class="va">s</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Join observed + predicted ----</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">df_obs</span>, <span class="va">df_pred</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"fishery"</span>, <span class="st">"length"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">year.y</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">year.x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Plot fishery 8 ----</span></span>
<span><span class="va">yrs_plot</span> <span class="op">&lt;-</span> <span class="fl">146</span><span class="op">:</span><span class="fl">188</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">fishery</span> <span class="op">==</span> <span class="st">"8"</span>, <span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">yrs_plot</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">obs</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"grey70"</span>, width <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_sim_all</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">fishery</span> <span class="op">==</span> <span class="st">"8"</span>, <span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">yrs_plot</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">sim</span>, group <span class="op">=</span> <span class="va">sim_id</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"steelblue"</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pred</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"red3"</span>, linewidth <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">year</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Length (cm)"</span>, y <span class="op">=</span> <span class="st">"Proportion"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Length composition: Fishery 8"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Grey bars = observed, red = predicted, blue = simulated"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="bet_files/figure-html/lf-diagnostics-1.png" class="r-plt" alt="" width="672"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># ---- Plot fishery 9 ----</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">fishery</span> <span class="op">==</span> <span class="st">"9"</span>, <span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">yrs_plot</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">obs</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"grey70"</span>, width <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_sim_all</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">fishery</span> <span class="op">==</span> <span class="st">"9"</span>, <span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">yrs_plot</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">sim</span>, group <span class="op">=</span> <span class="va">sim_id</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"steelblue"</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pred</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"red3"</span>, linewidth <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">year</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Length (cm)"</span>, y <span class="op">=</span> <span class="st">"Proportion"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Length composition: Fishery 9"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Grey bars = observed, red = predicted, blue = simulated"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="bet_files/figure-html/lf-diagnostics-2.png" class="r-plt" alt="" width="672"></p>
<p>Inspect fitted CPUE and catch:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">cpue_data</span><span class="op">$</span><span class="va">value</span>, col <span class="op">=</span> <span class="fl">2</span>, pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time step"</span>, ylab <span class="op">=</span> <span class="st">"CPUE"</span>, main <span class="op">=</span> <span class="st">"CPUE: observed vs predicted"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">cpue_log_obs</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"gray70"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="fu">report</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">cpue_pred</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="bet_files/figure-html/opt-cpue-1.png" class="r-plt" alt="" width="672"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="fu">report</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">catch_pred_ysf</span> <span class="op">-</span> <span class="va">data</span><span class="op">$</span><span class="va">catch_obs_ysf</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.9998036</span></span>
<span><span class="fu"><a href="../reference/plot_catch.html">plot_catch</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, obj <span class="op">=</span> <span class="va">obj</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "The maximum catch difference was: 7.91827369539533e-06"</span></span></code></pre></div>
<p><img src="bet_files/figure-html/opt-catch-1.png" class="r-plt" alt="" width="672"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_catch.html">plot_catch</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, obj <span class="op">=</span> <span class="va">obj</span>, plot_resid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "The maximum catch difference was: 7.91827369539533e-06"</span></span></code></pre></div>
<p><img src="bet_files/figure-html/opt-catch-2.png" class="r-plt" alt="" width="672"></p>
<p>Inspect estimated spawning biomass trajectory:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="fu">report</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">spawning_biomass_y</span>, type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time step"</span>, ylab <span class="op">=</span> <span class="st">"Spawning biomass (mt)"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Estimated spawning biomass trajectory"</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="fu">report</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">spawning_biomass_y</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="bet_files/figure-html/opt-spbio-1.png" class="r-plt" alt="" width="672"></p>
</div>
<div class="section level3">
<h3 id="selectivity">Selectivity<a class="anchor" aria-label="anchor" href="#selectivity"></a>
</h3>
<p>Visualise the selectivity curves by fleet (at length):</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">par_sel_est</span> <span class="op">&lt;-</span> <span class="va">obj</span><span class="op">$</span><span class="va">env</span><span class="op">$</span><span class="fu">parList</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">par_sel</span></span>
<span></span>
<span><span class="va">fleet_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F01_LL.NORTH"</span>, <span class="st">"F02_LL.US"</span>, <span class="st">"F03_LL.OFFSH"</span>,</span>
<span>                 <span class="st">"F04_LL.EQUAT"</span>, <span class="st">"F05_LL.WEST"</span>, <span class="st">"F06_LL.SOUTH"</span>, <span class="st">"F07_LL.AUS"</span>,</span>
<span>                 <span class="st">"F08_PS.ASSOC"</span>, <span class="st">"F09_PS.UNASS"</span>, <span class="st">"F10_DOM.MISC"</span>,</span>
<span>                 <span class="st">"F11_DOM.HL"</span>, <span class="st">"F12_JP.PS.N"</span>, <span class="st">"F13_JP.PL"</span>, <span class="st">"F14_EQ.PL"</span>,</span>
<span>                 <span class="st">"S01_INDEX"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sel_len_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">n_fishery</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">par_f</span> <span class="op">&lt;-</span> <span class="va">par_sel_est</span><span class="op">[</span><span class="va">f</span>, <span class="op">]</span></span>
<span>  <span class="va">sel_l</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">sel_type_f</span><span class="op">[</span><span class="va">f</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1L</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/sel_logistic.html">sel_logistic</a></span><span class="op">(</span><span class="va">len_mid</span>, <span class="va">par_f</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/sel_double_normal.html">sel_double_normal</a></span><span class="op">(</span><span class="va">len_mid</span>, <span class="va">par_f</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    fishery    <span class="op">=</span> <span class="va">f</span>,</span>
<span>    fleet_name <span class="op">=</span> <span class="va">fleet_names</span><span class="op">[</span><span class="va">f</span><span class="op">]</span>,</span>
<span>    length     <span class="op">=</span> <span class="va">len_mid</span>,</span>
<span>    selectivity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sel_l</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sel_len_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">length</span>, y <span class="op">=</span> <span class="va">selectivity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">fleet_name</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Length (cm)"</span>, y <span class="op">=</span> <span class="st">"Selectivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="bet_files/figure-html/plot-selectivity-length-1.png" class="r-plt" alt="Selectivity-at-Length by Fleet" width="960"><p class="caption">
Selectivity-at-Length by Fleet
</p>
</div>
<p>Visualise the selectivity curves by fleet (at age):</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rep</span> <span class="op">&lt;-</span> <span class="va">obj</span><span class="op">$</span><span class="fu">report</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">sel_fya</span> <span class="op">&lt;-</span> <span class="va">rep</span><span class="op">$</span><span class="va">sel_fya</span></span>
<span></span>
<span><span class="va">sel_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>fishery <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">data</span><span class="op">$</span><span class="va">n_fishery</span>, age <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">data</span><span class="op">$</span><span class="va">n_age</span><span class="op">)</span></span>
<span><span class="va">sel_df</span><span class="op">$</span><span class="va">selectivity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sel_df</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sel_fya</span><span class="op">[</span><span class="va">sel_df</span><span class="op">$</span><span class="va">fishery</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">sel_df</span><span class="op">$</span><span class="va">age</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">sel_df</span><span class="op">$</span><span class="va">real_age</span> <span class="op">&lt;-</span> <span class="va">sel_df</span><span class="op">$</span><span class="va">age</span> <span class="op">/</span> <span class="fl">4</span></span>
<span><span class="va">sel_df</span><span class="op">$</span><span class="va">fleet_name</span> <span class="op">&lt;-</span> <span class="va">fleet_names</span><span class="op">[</span><span class="va">sel_df</span><span class="op">$</span><span class="va">fishery</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sel_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">real_age</span>, y <span class="op">=</span> <span class="va">selectivity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">fleet_name</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Age (years)"</span>, y <span class="op">=</span> <span class="st">"Selectivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="bet_files/figure-html/plot-selectivity-1.png" class="r-plt" alt="Selectivity-at-Age by Fleet" width="960"><p class="caption">
Selectivity-at-Age by Fleet
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="simulation">Simulation<a class="anchor" aria-label="anchor" href="#simulation"></a>
</h2>
<p>The CPUE series is set up using RTMB’s <code>OBS</code> mechanism
inside the model, which allows simulation via
<code>obj$simulate()</code>. For example:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">cpue_data</span><span class="op">$</span><span class="va">value</span><span class="op">)</span>, col <span class="op">=</span> <span class="fl">2</span>, pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time step"</span>, ylab <span class="op">=</span> <span class="st">"log(CPUE)"</span>, main <span class="op">=</span> <span class="st">"Observed vs simulated CPUE"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="fu">report</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">cpue_pred</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">cpue_log_obs</span>, col <span class="op">=</span> <span class="st">"gray70"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bet_files/figure-html/sim-1-1.png" class="r-plt" alt="" width="672"></p>
</div>
<div class="section level2">
<h2 id="one-step-ahead-osa-residuals">One step ahead (OSA) residuals<a class="anchor" aria-label="anchor" href="#one-step-ahead-osa-residuals"></a>
</h2>
<p>OSA residuals are a replacement for Pearson residuals:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">osa_cpue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RTMB/man/OSA-residuals.html" class="external-link">oneStepPredict</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">obj</span>, observation.name <span class="op">=</span> <span class="st">"cpue_log_obs"</span>,</span>
<span>                           method <span class="op">=</span> <span class="st">"oneStepGeneric"</span>, trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">qqnorm</a></span><span class="op">(</span><span class="va">osa_cpue</span><span class="op">$</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="bet_files/figure-html/osa1-1.png" class="r-plt" alt="" width="672"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">osa_cpue</span><span class="op">$</span><span class="va">res</span>, xlab <span class="op">=</span> <span class="st">"Index"</span>, ylab <span class="op">=</span> <span class="st">"OSA residual"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="bet_files/figure-html/osa1-2.png" class="r-plt" alt="" width="672"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Darcy Webber, Philipp Neubauer, Nicholas Ducharme-Barth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
